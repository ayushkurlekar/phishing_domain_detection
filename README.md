	 ____________________________________________________________________________________
	|  ____  _   _ ___ ____  _   _       ____  _____ _____ _____ ____ _____ ___  ____    |
	| |  _ \| | | |_ _/ ___|| | | |     |  _ \| ____|_   _| ____/ ___|_   _/ _ \|  _ \   |
	| | |_) | |_| || |\___ \| |_| |_____| | | |  _|   | | |  _|| |     | || | | | |_) |  |
	| |  __/|  _  || | ___) |  _  |_____| |_| | |___  | | | |__| |___  | || |_| |  _ <   |
	| |_|   |_| |_|___|____/|_| |_|     |____/|_____| |_| |_____\____| |_| \___/|_| \_\  |
	|____________________________________________________________________________________|                                                                                 


# Phishing Domain Detection							
**Purpose:** This file has rules functions to detect phishing domain<br>														
**Author:** DIMA DEVELOPERS (https://dimabusiness.com)<br>	
**Licence:** MIT<br>	
**Results Calibration:**
1. if ouput is 1 ------> PHISHING
2. if ouput is 0 ------> SUSPICIOUS
3. if ouput is -1 ------> LEGITIMATE<br>

**Total Rules:** 19<br>	
**Phishing score:** out of 10<br>	
**NOTE:** if Phishing score is more than 2 then >>> Domain is predicted as Phishing<br>	

# To run:<br>	
**Install PIP packages:**<br>
`pip3 install -r requirements.txt`<br>
**Add domains to be predicted in domains_list.txt and finally run**<br>
`$ python3 rules.py`

Detect Phishing domain with 19 different rules
----------------------------------------------------------------------------------
Rule 01: using raw ip address
----------------------------------------------------------------------------------
1. If The Domain Part has an IP Address ---> Phishing ----> 1
2. otherwise ---> Legitimate ----> -1
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 02: Long Domain to Hide the Suspicious Part
----------------------------------------------------------------------------------
1. Domain length < 15 ---> Legitimate ----> -1
2. Domain length >= 15 and <= 30 ---> Suspicious -----> 0
3. otherwise ---> Phishing ----> 1
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------


----------------------------------------------------------------------------------
Rule 03: Adding Prefix or Suffix Separated by (-) to the Domain
----------------------------------------------------------------------------------
1. If - dash symbol is in domain ---> Phishing ----> 1
2. otherwise ---> Legitimate ----> -1
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 04: Sub Domain and Multi Sub Domains
----------------------------------------------------------------------------------
1. If domain part (dots in domain) = 1 ---> Legitimate ----> -1
2. If domain part (dots in domain) = 2 ---> Suspicious -----> 0
3. otherwise ---> Phishing ----> 1
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 05: HTTPS (Hyper Text Transfer Protocol with Secure Sockets Layer) 
----------------------------------------------------------------------------------
1. If ssl certificate with verified issuer ---> Legitimate ----> -1
2. otherwise ---> Phishing ----> 1
----------------------------------------------------------------------------------
Output: (1,  -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 06: Domain Registration Period length
----------------------------------------------------------------------------------
1. Domain expires on > 1 year ---> Legitimate ----> -1
2. otherwise ---> Phishing ----> 1 (Below 1 year and below period is suspicious)
----------------------------------------------------------------------------------
Output: (1,  -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 07: Favicon - loads from same domain or not
----------------------------------------------------------------------------------
1. Domain loads a favicon from same domain ---> Legitimate ----> -1
2. Domain does not load favicon ---- > 0
3. Domain loads a favicon from external domain ---> Phishing ----> 1 

----------------------------------------------------------------------------------
Output: (1, 0 -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 08: The Existence of “HTTPS” Token in the Domain Part
----------------------------------------------------------------------------------
1. Domain doesn't have "HTTPS" in domain ---> Legitimate ----> -1
2. Otherwise ---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 09: Alexa Ranking
----------------------------------------------------------------------------------
1. Domain in rank below 2000000 ---> Legitimate ----> -1
2. Otherwise ---> Phishing ----> 1
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 10: webpage such as images, videos and sounds are loaded from another domain
----------------------------------------------------------------------------------
1. % of Request URL loads from same Domain < 22 % ---> Legitimate ----> -1
2. % of Request URL loads from same Domain < 22 % and > 61 % -----> Suspicious ---> 0
3. Otherwise ---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 11: Empty anchor links in website : "#", "#content", "#skip", "JavaScript ::void(0)"
----------------------------------------------------------------------------------
1. % of Empty anchor links < 31 % ---> Legitimate ----> -1
2. % of Empty anchor links >= 31 % and <= 67 %-----> Suspicious ---> 0
3. Otherwise ---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 12: Server Form handler --- domain and mail to 
----------------------------------------------------------------------------------
1. If Server Form handler actions is Same domain ---> Legitimate ----> -1
2. If Server Form handler actions are to different domain----> Suspicious ---> 0
3. If server form handler actions are blank or using MAILTO: ---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 13: Website Forwarding 
----------------------------------------------------------------------------------
1. If website redirects max 2 times or lesser than that ---> Legitimate ----> -1
2. If website redirects 3 or more times but lesser than 4----> Suspicious ---> 0
2. If website redirects more than---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 14: Disabling Right Click checker
----------------------------------------------------------------------------------
1. If webpage does not have right click disabled ---> Legitimate ----> -1
2. finds nothing -----> Suspicious --- 0
3. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 15: Iframe and iframeborder check
----------------------------------------------------------------------------------
1. If webpage does not have iframe ---> Legitimate ----> -1
2. find iframe but with iframeborder = 1 -----> Suspicious --- 0
3. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, 0, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 16: Check DNS Record 
----------------------------------------------------------------------------------
1. If domain has dns records ---> Legitimate ----> -1
2. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 17: Check google indexing
----------------------------------------------------------------------------------
1. If domain is indexed in google ---> Legitimate ----> -1
2. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 18: Check digits count in domain
----------------------------------------------------------------------------------
1. If domain has less than 4 digits ---> Legitimate ----> -1
2. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------

----------------------------------------------------------------------------------
Rule 19: Check phishing abusive words in domain
----------------------------------------------------------------------------------
1. If domain does not have abusive phishing keyword ---> Legitimate ----> -1
2. Otherwise---> Phishing ----> 1 
----------------------------------------------------------------------------------
Output: (1, -1)
----------------------------------------------------------------------------------
